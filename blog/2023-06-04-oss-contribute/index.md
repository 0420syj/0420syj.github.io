---
slug: oss-contribute
title: "오픈소스 기여 후기 💻"
description: "facebook/docusaurus에 기여한 후기를 남깁니다."
image: "./images/preview.png"
authors: [wannysim]
tags: [yarn, yarn berry, package, "yarn upgrade", "yarn upgrade-interactive"]
enableComments: true
---

[facebook/docusaurus](https://github.com/facebook/docusaurus)에 기여한 후기를 남깁니다.

<!-- truncate -->

# 오픈소스 기여 후기 💻

## 개요

[facebook/docusaurus](https://github.com/facebook/docusaurus)에 PR을 통해 기여한 후기를 남깁니다.

PR 링크 : [#9006](https://github.com/facebook/docusaurus/pull/9006)

## 배경

평소에 docuaurus에 관심이 많았습니다.
이 블로그도 docusaurus로 만들기도 했고, facebook(현 Meta)에서 만들었다보니 여러모로 이점이 많습니다.

그러던 중 작은 오류를 발견했습니다.
새로운 version이 release되어, yarn을 통해 어떻게 upgrade 할 수 있는지 console 메시지가 나왔는데, 업그레이드 명령어가 잘못 나오고 있었습니다.

저는 yarn berry를 쓰고 있어서, `yarn up`이 사용되어야 하는데 `yarn upgrade`가 나오고 있었습니다.

언젠가 큰 오픈소스에 contribution 하고 싶은 욕심이 있었는데, 이때다 싶어 오류를 수정하고 PR을 날려보기로 했습니다.

## 과정

첫 contribution은 아니지만, 이정도로 큰 오픈소스 프로젝트는 처음이었습니다.

또한 처음으로 오픈소스에 contribution 하고 싶은 분들이게 도움이 될 것 같아, 과정을 상세하게 기록하고자 합니다.

### 1. 최신 코드 확인

우선 main 브랜치의 최신 코드를 보고 문제를 파악했습니다.
그런데, 누군가에 의해 이미 버그가 수정되어 있었습니다.

새로 release된 version에서 이미 수정된 것이었습니다.

혹시 모르니 해당 파일의 history를 찾아보고, 어떻게 수정되었는지 살펴보기로 합니다.

### 2. 문제 파악

당시 기준으로 1달 전에 또 다른 contributor에 의해 버그가 수정되었습다. 코드를 보니 그 아이디어가 아주 좋았습니다.

그렇게 이 버그로 PR하지 못하겠구나라는 생각이 들던 찰나, 새로운 버그가 보였습니다.
검증을 해보니, 특정 조건에서 yarn version을 다르게 인식하는 버그가 있었습니다.

저같은 주니어 개발자도 발견한 버그였으니, 이제부터는 누가 먼저 정확하고 빠르게 PR을 작성하느냐 문제입니다.

Issues에 이미 누군가 지적했는지 살펴봅니다. 없었습니다.
마지막으로 Pull Requests에 이미 누군가 같은 내용을 작성했는지 살펴봅니다. 없었습니다.

### 3. `CONTRIBUTING.md` 읽어보기

규모있는 오픈소스 프로젝트에는 `CONTRIBUTING.md` 파일이 무조건 존재한다.
읽지 않고 무작정 PR을 날리면 reject 당하는 것은 물론 maintainers에게 불편을 끼칠 수도 있다.

그래서 [`CONTRIBUTING.md`](https://github.com/facebook/docusaurus/blob/main/CONTRIBUTING.md#pull-requests) 파일을 읽어보았다.

### 4. 코드 수정

해당 프로젝트를 fork한 후, 수정한 코드를 커밋했다.
커밋 메시지도 규칙에 맞게 작성했다.

### 5. PR 날리기

PR도 규칙에 맞게 작성했다.
이미 Merge된 PR들도 살펴보고, 어떤 식으로 작성해야 하는지 감을 잡았다.

maintainer를 위해 PR 양식에 아주 상세하게 설명했다.
어떤 문제를, 왜, 어떻게 수정했는지, 그리고 어떻게 테스트했는지 등을 자세히 적었다.

나에게 사실상 이 아이디어를 제공해준 이전 PR을 태그하여, 비교하기 쉽게 만들었다.

PS. 처음 PR을 날린 후에 수정할 수도 있다는 것을 알게 되었다.
다만 최초 PR의 commit이 여러개인 경우, maintainers가 혼란스러워할 수 있으니 squash해서 하나의 commit으로 만들었다.
과거에 다른 프로젝트에서는 PR 규칙 중, 반드시 1PR에 1개의 commit만 있어야 한다는 규칙이 있었다.
여기에는 그런 규칙은 없었지만, 가급적 1PR에 1개의 commit이 있어야 한다고 것에 대해서는 리뷰어 관점에서 전적으로 동의한다.

### 6. 1번째 리뷰

PR을 날리고 나서는, 리뷰를 받기 위해 기다렸다.
첫 리뷰는 일주일 후에 왔다.

리뷰어는 내 아이디어에 대해서는 동의했는지,
바로 코드를 어떻게 개선할 수 있는지 보여주었다.

나는 `js-yaml`이라는 라이브러리를 사용했는데,
리뷰어는 대신 `shelljs`를 사용하여 훨씬 쉽게 문제를 해결했다.
나도 처음에는 `shelljs`를 사용하려고 했는데, 사용자의 shell에 접근한다는 점이 다소 마음에 걸렸다.

그러나, 그 리뷰를 받고 확인해보니 해당 package는 이미 `shelljs`를 사용하고 있었다.
그렇다면 당연히 리뷰 내용을 수용하지 않을 이유가 없다.

### 7. 리뷰 확인 후, 코드 수정

리뷰 내용에 대한 답글을 남겼다.
당연히 리뷰어의 코드가 훨씬 간결하고, 명령어로 yarn 버전을 확인한다는 점에서 기능적으로도 확실했다.

처음 PR을 날린 후로 일주일이나 시간이 흘렀기 때문에
우선 main 브랜치를 pull 받아서 최신 코드를 확인했다.
다행히 충돌은 없었다.

리뷰어의 코드를 바탕으로 코드를 수정했다.
코드를 조금 더 null safe하게 만들었다.
현재 PR에 대한 리뷰에 따른 history를 남기기 위해, 최초 PR 이후에는 squash하지 않았다.

### 8. 2번째 리뷰 & 코드 수정

2번째 리뷰는 하루도 안되어서 왔다.
이번엔 다른 리뷰어가 리뷰를 해주었다.

해당 리뷰어는 현재 코드에 문제점이 있을 수 있다고 지적했다.

나는 댓글로 그의 리뷰에 동의하며
정확히 어떤 상황에서 문제가 발생할 수 있는지 설명했다.
더불어 그 문제를 해결하기 위해 어떻게 코드를 수정할 수 있는지도 댓글로 남겼다.

위에 설명한대로 코드를 수정하고,
추가적으로 맥락상 더 알맞도록 메서드명을 수정했다.
메서드명 수정에 대해서는 왜 이것이 맥락상 더 알맞은지에 대해서도 설명했다.

### 9. 마지막 리뷰

2번째 리뷰어가 리뷰를 해주었다.

불필요한 연산자를 제거하는 것을 제안했다.
왜 그것이 불필요한지 생각해보고, 왜 그 연산자를 제거하는게 더 나은지에 대한 설명과 함께
리뷰어의 리뷰를 내가 받아들였다.

제안을 수락하자 바로 commit이 이루어졌다.

해당 리뷰어가 이 PR에 대해 나와 함께 공동 작업이 이루어졌다.
`Co-authored-by: 2번째 리뷰어` 라는 메세지가 commit description에 추가되었다.

### 10. PR Merge

처음 리뷰해주었던 리뷰어가
오픈소스 세계에서는 마지막 리뷰라고 할 수 있는 그 댓글, "LGTM"을 남겼다.

이윽고 PR이 Merge되었다.

### 11. 마무리

내가 작업했던 branch, fork한 repo를 삭제했다.

이 코드는 docusaurus main repo에 반영되었다.
아마 v2.4.2부터는 해당 버그가 수정되었을 것이다.

이제 yarn berry를 사용하는 사람들은
올바른 버전 업그레이드 명령어를 확인할 수 있을 것이다.

## 후기

느꼈던 내용과 배운점
